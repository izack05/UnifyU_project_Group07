{% extends 'admin/master.html' %}

{# --- Custom Page Title --- #}
{% block title %}UnifyU Admin Panel{% endblock %}

{# --- Custom Head (CSS/JS) --- #}
{% block head %}
    {{ super() }}

    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/UnifyU_logo_finPNG.png') }}">
    
<nav class="navbar navbar-expand-lg" style="background-color: #1f65dc;">
  <div class="container-fluid">
    <a class="navbar-brand" href="{{ url_for('homepage') }}" style="color: #ffffff; text-decoration: underline !important;">UnifyU</a>
    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    
    <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="navbar-nav" style="margin-left: auto;">

        <li class="nav-item">
          <a class="nav-link btn btn-outline-primary mx-1" href="{{ url_for('admin.index') }}" style="color: #ece3e3">Admin Panel</a>
        </li>
        
        <li class="nav-item">
          <a class="nav-link btn btn-outline-primary mx-1" href="{{ url_for('homepage') }}" style="color: #ece3e3">Home</a>
        </li>
        
      </ul>
    </div>
  </div>
</nav>
{% endblock %}



{# --- Custom Navbar Brand (logo + name) --- #}
{% block brand %}
<a class="navbar-brand" href="{{ url_for('admin.index') }}">
    <img src="{{ url_for('static', filename='images/UnifyU_logo_finPNG.png') }}" height="30" alt="Logo">
    Admin Panel
</a>
{% endblock %}

{# --- Main Navbar Menu --- #}
{% block main_menu %}
<ul class="navbar-nav mr-auto">
    <li class="nav-item">
        <a class="nav-link" href="{{ url_for('admin.index') }}">Home</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="/admin/studentregistration/">Users</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="/admin/fooditem/">Food Items</a>
    </li>
     <li class="nav-item">
        <a class="nav-link" href="{{ url_for('actions.index') }}">Club Actions</a>
    </li>
</ul>
{% endblock %}


{% block body %}
<div class="container mt-4">
    <h2 style="text-align: center;">ðŸ“Š Site Overview</h2>
    <body>
      <br><br>
      <!-- First row -->
      <div class="row">
        <div class="col-md-6 mb-4">
          <div class="chart-bar">
            <canvas id="user_type_barchart"></canvas>
          </div>
        </div>
      </div>

      <h3 style="text-align: center;">Club info</h3>
      <!-- Club info row -->
      <div class="row mt-4">
        <div class="col-md-6 mb-4">
          <div class="chart-bar">
            <canvas id="club_member_count_barchart"></canvas>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="chart">
            <canvas id="club_app_doughnut"></canvas>
          </div>
        </div>
      </div>

      <h3 style="text-align: center;">Issue Log Info</h3>
      <!-- Another row -->
      <div class="row mt-4">
        <div class="col-md-6 mb-4">
          <div class="chart">
            <canvas id="doughnut2"></canvas>
          </div>
        </div>
        <div class="col-md-6 mb-4">
          <div class="chart">
            <canvas id="futurechart"></canvas>
          </div>
        </div>
      </div> 

      <h3 style="text-align: center;">PlaceHolder title</h3>
      <!-- Future chart row -->
      <div class="row mt-4">
        <div class="col-md-6 mb-4">
          <div class="chart">
            <canvas id="futurechart"></canvas>
          </div>
        </div>
      </div>  

      <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

      <script>
        const ctxBar = document.getElementById('user_type_barchart');

        new Chart(ctxBar, {
          type: 'bar',
          data: {
            labels: ['Students', 'Verified Students', 'Unverified Students', 'Staff(s)', 'Admin(s)'],
            datasets: [{
              label: 'Number of different User Types',
              data: [
                {{ student_count }}, 
                {{ verified_students_count }}, 
                {{ unverified_students_count }}, 
                {{ staff_count }}, 
                {{ admin_count }}
              ],
              borderWidth: 1
            }]
          },
          options: {
            scales: {
              y: {
                beginAtZero: true,
                max: {{ total }}
              }
            }
          }
        });
      </script>

      <script>
        const ctxBar2 = document.getElementById('club_member_count_barchart');

        new Chart(ctxBar2, {
          type: 'bar',
          data: {
            labels: {{ club_names | tojson }},
            datasets: [{
              label: 'Number of club members',
              data: {{ club_member_count | tojson }},
              borderWidth: 1
            }]
          },
          options: {
            scales: {
              y: {
                beginAtZero: true,
                max: {{ max_club_members }}
              }
            }
          }
        });
      </script>
      
      <script>
        const ctxDoughnut = document.getElementById('club_app_doughnut');

        new Chart(ctxDoughnut, {
          type: 'doughnut',
          data: {
            labels: {{ club_app_name | tojson }},
            datasets: [{
              label: 'Number of appicants',
              data: {{ club_app_count | tojson }},
              borderWidth: 1
            }]
          },
          options: {
            scales: {
              y: {
                beginAtZero: true
              }
            }
          }
        });
      </script>
      <script>
        const ctxDoughnut2 = document.getElementById('doughnut2');

        new Chart(ctxDoughnut2, {
          type: 'doughnut',
          data: {
            labels: ["Reported", "On-Process", "Solved"],
            datasets: [{
              label: "Logged Issue Status'",
              data: [{{ reported }}, {{ on_process }}, {{ solved }} ],
              borderWidth: 1,
              backgroundColor: [
                '#ff6384',  // Reported â†’ Red
                '#ffce56',  // On-Process â†’ Yellow
                '#4caf50'   // Solved â†’ Green
              ],
              borderColor: '#fff',   // optional white borders between slices
              hoverOffset: 10 
              //data: ["Reported", "On-Process", "Solved"]
            }]
          },
          options: {
            scales: {
              y: {
                beginAtZero: true
              }
            },
            responsive: true,
            title: {
              display: true,
              text: 'Logged Issue Status',  // ðŸ‘ˆ This is the visible title
              font: {
                size: 18,
                weight: 'bold'
              },
              padding: {
                top: 10,
                bottom: 30
              }
            }
          }
        });
      </script>
      <style>

        .chart-bar {
          width: 100%;
          height: 450px;  /* force same height */
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .chart {
          width: 100%;
          height: 350px;  /* force same height */
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .chart canvas {
          max-width: 100% !important;
          max-height: 100% !important;
        }
      </style>
    </body>
    
{% endblock %}

{# --- Access Control (login/logout buttons) --- #}
{% block access_control %}
{{ super() }}
{% endblock %}

{# --- Messages / Alerts --- #}
{% block messages %}
{{ super() }}
{% endblock %}

{# --- Custom Header Above Content --- #}
{% block page_body %}
    

{# Render default admin content (tables, forms, etc.) #}
{{ super() }}
{% endblock %}

{# --- Optional Footer Area --- #}
{% block tail %}
{% include "layout/footer.html" %}
{% endblock %}